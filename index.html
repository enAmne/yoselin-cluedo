<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Yoselin Cluedo</title>
    <link rel="manifest" href="./manifest.webmanifest">
    <link rel="stylesheet" href="./css/style.css">
    <meta name="theme-color" content="#121212">
    
    <script>
      // Ajuste din√°mico del fondo para GitHub Pages con rutas de respaldo
      // Comentarios en espa√±ol: probamos varias rutas hasta encontrar una que cargue
      (function() {
        const esGithub = location.host.endsWith('github.io');
        const segmentoRepositorio = esGithub ? (location.pathname.split('/')[1] || '') : '';
        const base = segmentoRepositorio ? '/' + segmentoRepositorio : '';

        // Redirecci√≥n can√≥nica: si la URL termina en /index.html, reemplazar por la ra√≠z
        // Comentarios en espa√±ol: esto deja la misma p√°gina pero limpia la URL
        if (esGithub && location.pathname.endsWith('/index.html')) {
          try {
            history.replaceState(null, '', base + '/');
            console.log('URL normalizada a la ra√≠z:', base + '/');
          } catch (e) {
            console.warn('No se pudo normalizar la URL:', e);
          }
        }

        const rutasPosibles = [
          base + '/assets/lamansiondeyoselin.jpg',
          './assets/lamansiondeyoselin.jpg',
          'assets/lamansiondeyoselin.jpg'
        ];

        function probarRuta(indice) {
          if (indice >= rutasPosibles.length) {
            console.warn('No se pudo cargar ninguna ruta de fondo. Se mantiene el fondo por defecto.');
            return;
          }
          const ruta = rutasPosibles[indice];
          const img = new Image();
          img.onload = function() {
            document.documentElement.style.setProperty('--fondo', `url('${ruta}')`);
            document.body.style.backgroundImage = `linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.5)), url('${ruta}')`;
            console.log('Fondo aplicado correctamente:', ruta);
          };
          img.onerror = function() {
            console.warn('No se pudo cargar el fondo en la ruta:', ruta);
            probarRuta(indice + 1);
          };
          img.src = ruta;
        }

        probarRuta(0);
      })();
    </script>
  
    <!-- Meta tags para Netlify -->
    <meta name="description" content="Juego de Cluedo personalizado - La mansi√≥n de Yoselin">
    <meta name="keywords" content="cluedo, juego, misterio, yoselin">
    <meta name="author" content="Yoselin">
    
    <!-- Open Graph para compartir -->
    <meta property="og:title" content="Yoselin Cluedo">
    <meta property="og:description" content="Juega al Cluedo en la mansi√≥n de Yoselin">
    <meta property="og:image" content="./assets/lamansiondeyoselin.jpg">
    <meta property="og:type" content="website">
  </head>
  <body>
    <!-- Pantalla de inicio -->
    <section id="pantalla-inicio" class="pantalla visible">
      <main class="contenedor">
        <p class="intro-bienvenida">¬°Bienvenido a la mansi√≥n misteriosa de Yoselin!</p>
        
        <section class="botonera">
          <button id="btn-nuevo-juego" class="btn">Iniciar nuevo juego</button>
          <button id="btn-continuar" class="btn">Continuar juego</button>
          <button id="btn-configurar" class="btn">Configurar juego</button>
          <button id="btn-salir" class="btn btn-secundario">Salir de la aplicaci√≥n</button>
        </section>

        <p id="mensaje" class="mensaje"></p>
      </main>
    </section>

    <!-- Pantalla de configuraci√≥n -->
    <section id="pantalla-configuracion" class="pantalla">
      <div class="contenedor">
        <h2 class="titulo">‚öôÔ∏è Configuraci√≥n</h2>
        
        <div class="formulario-config">
          <div class="campo">
            <label for="cfg-jugadores">N√∫mero de jugadores:</label>
            <input type="number" id="cfg-jugadores" min="2" max="8" value="4">
          </div>
          
          <div class="campo">
            <label for="cfg-idioma">Idioma:</label>
            <select id="cfg-idioma">
              <option value="es">Espa√±ol</option>
              <option value="en">English</option>
            </select>
          </div>
        </div>

        <div class="botonera">
          <button id="btn-guardar-config" class="btn">Guardar configuraci√≥n</button>
          <button id="btn-volver-inicio" class="btn btn-secundario">Volver al inicio</button>
        </div>

        <p id="mensaje-config" class="mensaje"></p>
      </div>
    </section>

    <!-- Pantalla de juego -->
    <section id="pantalla-juego" class="pantalla">
      <div class="contenedor">
        <h2 class="titulo">üé≤ Partida en curso</h2>
        
        <div class="area-juego">
          <p>Aqu√≠ ir√° el desarrollo del juego tipo Cluedo</p>
          <p>Estado: <span id="estado-partida">En espera</span></p>
        </div>

        <div class="botonera">
          <button id="btn-guardar-partida" class="btn">Guardar partida</button>
          <button id="btn-terminar-partida" class="btn btn-secundario">Terminar partida</button>
          <button id="btn-ir-inicio-desde-juego" class="btn btn-secundario">Volver al inicio</button>
        </div>

        <p id="mensaje-juego" class="mensaje"></p>
      </div>
    </section>

    <!-- Scripts -->
    <script src="./js/app.js"></script>
    <script>
      // Registro del Service Worker para instalaci√≥n y uso offline
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('./sw.js')
            .then(registration => {
              console.log('ServiceWorker registrado correctamente:', registration);
            })
            .catch(error => {
              console.log('Error al registrar ServiceWorker:', error);
            });
        });
      }
      
      // Verificar que todos los elementos necesarios existen
      window.addEventListener('DOMContentLoaded', function() {
        const elementosNecesarios = [
          { id: 'pantalla-inicio', nombre: 'Pantalla de inicio' },
          { id: 'pantalla-configuracion', nombre: 'Pantalla de configuraci√≥n' },
          { id: 'pantalla-juego', nombre: 'Pantalla de juego' },
          { id: 'btn-nuevo-juego', nombre: 'Bot√≥n nuevo juego' },
          { id: 'btn-configurar', nombre: 'Bot√≥n configurar' },
          { id: 'btn-salir', nombre: 'Bot√≥n salir' }
        ];
        
        elementosNecesarios.forEach(elemento => {
          const elem = document.getElementById(elemento.id);
          if (!elem) {
            console.error('‚ùå Elemento no encontrado:', elemento.nombre, '(' + elemento.id + ')');
          } else {
            console.log('‚úÖ Elemento encontrado:', elemento.nombre);
          }
        });
      });
    </script>
  </body>
</html>